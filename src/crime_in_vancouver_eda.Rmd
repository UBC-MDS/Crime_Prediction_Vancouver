---
title: "Exploratory data analysis of Crime in Vancouver"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message=FALSE)
library(tidyverse)
library(knitr)
library(ggridges)
library(ggthemes)
library(ggplot2)
theme_set(theme_minimal())
set.seed(2020)
```

# Summary of the data set

```{r load data}
crime_data <- read.csv("../data/crime.csv")
crime_data |> 
  drop_na() |> 
  select(-X, -Y, -Latitude, -Longitude)
```

The data set used in this project comes from the Vancouver Open Data Catalogue. It includes 529.652 crimes reported between January 1, 2003 to July 13, 2017. The data set is also avialable on <https://www.kaggle.com/wosaku/crime-in-vancouver>

```{r}
# Type of crimes
# summary(crime_data)

```

Below you will find the table summarize the count of each reported crime type

```{r}
# Count type of crimes
# Use Pie Chart for visualization
type_crime <- crime_data |> 
  group_by(TYPE) |> 
  summarise(Count = n()) |> 
  mutate(Percentage=paste0(round(Count/sum(Count)*100,2),"%")) |> 
  arrange(desc(Count))
type_crime
```

Top three reported crime type are Theft from Vehicle, Mischief and Break and Enter Residential/Other.

```{r}
ggplot(type_crime, aes(x = "", y = Count, fill = TYPE)) +
  geom_col() +
  geom_text(aes(label = ifelse(type_crime$Count > 50000, Percentage, "")),
            position = position_stack(vjust = 0.5),
            show.legend = FALSE,
            size = 3) +
  coord_polar(theta = "y") +
  scale_y_discrete() +
  ggtitle('Crime by Percentage')
  
```

We would also explore the density of reported crime for each neighbourhoods

```{r}
# Count Neighbourhood with most crimes
neighbour_crime <- crime_data |> 
  group_by(NEIGHBOURHOOD) |> 
  summarize(Count = n()) |> 
  arrange(desc(Count)) |> 

neighbour_crime[-c(2),] # Remove crime without Neighbourhood data


```

```{r}
top_5_district <- head(neighbour_crime)
ggplot(top_5_district) +
  geom_bar(aes(x = reorder(NEIGHBOURHOOD, -Count),
               y = Count, fill=NEIGHBOURHOOD), 
           stat = "identity") +
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank()) +
  xlab("Neighbourhood") +
  ggtitle("Top 5 neighbouhoods with most reported crimes")

```
